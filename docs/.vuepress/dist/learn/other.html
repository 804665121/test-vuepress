<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>其它Composition API | Hello Vue3笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.8f93fd0e.css" as="style"><link rel="preload" href="/assets/js/app.175be109.js" as="script"><link rel="preload" href="/assets/js/2.3e96f17d.js" as="script"><link rel="preload" href="/assets/js/13.aee09df5.js" as="script"><link rel="prefetch" href="/assets/js/10.a5587606.js"><link rel="prefetch" href="/assets/js/11.7a65169f.js"><link rel="prefetch" href="/assets/js/12.f7dee84a.js"><link rel="prefetch" href="/assets/js/14.9b828376.js"><link rel="prefetch" href="/assets/js/15.eac1a56f.js"><link rel="prefetch" href="/assets/js/16.7305790f.js"><link rel="prefetch" href="/assets/js/17.9fc21f29.js"><link rel="prefetch" href="/assets/js/18.81bc56e1.js"><link rel="prefetch" href="/assets/js/3.8cf05a49.js"><link rel="prefetch" href="/assets/js/4.f1aece4c.js"><link rel="prefetch" href="/assets/js/5.7ef5f63d.js"><link rel="prefetch" href="/assets/js/6.f2da0026.js"><link rel="prefetch" href="/assets/js/7.f5f1cf75.js"><link rel="prefetch" href="/assets/js/8.c93df86c.js"><link rel="prefetch" href="/assets/js/9.015a7c32.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f93fd0e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hello Vue3笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/learn/" class="nav-link router-link-active">
  菜单
</a></div> <a href="https://github.com/804665121/vue3note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/learn/" class="nav-link router-link-active">
  菜单
</a></div> <a href="https://github.com/804665121/vue3note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>目录</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/ref.html" class="sidebar-link">ref函数</a></li><li><a href="/learn/reactive.html" class="sidebar-link">reactive函数</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/life.html" class="sidebar-link">生命周期</a></li><li><a href="/learn/hook.html" class="sidebar-link">hook</a></li><li><a href="/learn/watch.html" class="sidebar-link">watch的使用</a></li><li><a href="/learn/setup.html" class="sidebar-link">setup</a></li><li><a href="/learn/toref.html" class="sidebar-link">toref的使用</a></li><li><a href="/learn/other.html" aria-current="page" class="active sidebar-link">其它</a></li><li><a href="/learn/flag.html" class="sidebar-link">与vue2对比</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="其它composition-api"><a href="#其它composition-api" class="header-anchor">#</a> 其它Composition API</h1> <ul><li><h4 id="shallowreactive和shallowref"><a href="#shallowreactive和shallowref" class="header-anchor">#</a> shallowReactive和shallowRef</h4> <ul><li><strong>shallowReactive</strong>:只处理对象最外层的响应式(浅响应式)</li> <li><strong>shallowRef</strong>: 只处理基本数据类型的响应式,不进行对象的响应式</li> <li>什么时候使用?
<ul><li>如果又一个对象数据,结构比较深,但变卦时只是外层属性变化====&gt;<strong>shallowReactive</strong></li> <li>如果有一个对象数据,后续功能不会修改该对象中的属性,而是生新的对象来替代====&gt;<strong>shallowRefÏ</strong></li></ul></li></ul></li> <li><h4 id="readonly和shallowreadonly"><a href="#readonly和shallowreadonly" class="header-anchor">#</a> readonly和shallowReadonly</h4> <ul><li>readonly:让一个响应式的数据变为只读(深只读)</li> <li>shallowReadonly:让一个响应式数据变为只读的(浅只读)</li> <li>应用场景:不希望数据被修改时</li></ul></li> <li><h4 id="toraw与markraw"><a href="#toraw与markraw" class="header-anchor">#</a> toRaw与markRaw</h4> <ul><li>toRew
<ul><li>作用:讲一个有<strong>reactive</strong>生成的<strong>响应式数据</strong>转为<strong>普通对象</strong></li> <li>使用场景:用于读取响应式对象对应的普通对象,对这个普通对象的所有操作,不会引起页面的更新</li></ul></li> <li>markRaw
<ul><li>作用:标记一个对象,使其<strong>永远不会变成响应式对象</strong></li> <li>应用场景:
<ul><li>有些值不应该被响应式的,例如复杂的第三方库</li> <li>当渲染具有不可变数据源的大列表的时候,跳过响应式转换可以提高性能</li></ul></li></ul></li></ul></li> <li><h4 id="customref"><a href="#customref" class="header-anchor">#</a> customRef</h4> <ul><li><p>作用:创建一个自定义的ref,并对其依赖项跟踪和更新触发进行显示控制</p></li> <li><p>实现防抖效果</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;template&gt;
  &lt;h1&gt;自定义ref&lt;/h1&gt;
  &lt;div&gt;
    &lt;input type=&quot;text&quot; v-model=&quot;keyword&quot; /&gt;
    &lt;span&gt;{{ keyword }}&lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { customRef } from &quot;@vue/reactivity&quot;;
export default {
  setup() {
    // 防抖函数的实现
    function useCustomRef(value, delay = 2000) {
      return customRef((track, trigger) =&gt; {
        let timer;
        return {
          get() {
            console.log(value, &quot;get&quot;);
            track();
            return value;
          },
          set(newVal) {
            console.log(newVal, &quot;值被修改l1111&quot;);
            clearTimeout(timer);
            timer = setTimeout(() =&gt; {
              //默认等待2s之后再执行
              value = newVal;
              trigger();
            }, delay);
          },
        };
      });
    }
    let keyword = useCustomRef(&quot;hello&quot;, 1000);
    return {
      keyword,
    };
  },
};
&lt;/script&gt;

&lt;style&gt;
&lt;/style&gt;
</code></pre></div></li></ul></li> <li><h4 id="provide与inject"><a href="#provide与inject" class="header-anchor">#</a> provide与inject</h4> <ul><li><p>作用:实现<strong>祖孙之间</strong>的通信Ï</p></li> <li><p>套路:父组件有一个<strong>provide</strong>选项来提供数据,孙组件有<strong>inject</strong>选项来使用这些数据</p></li> <li><p>具体写法</p> <ul><li><p>祖组件写法</p> <div class="language- extra-class"><pre class="language-text"><code>import { reactive,toRefs, provide } from &quot;vue&quot;; //引入provide
 setup() {
    let person = reactive({
      name: &quot;章三&quot;,
      age: 24,
      job: 20,
    });

    provide(&quot;user&quot;, person);

    return {
      ...toRefs(person),
    };
  },
</code></pre></div></li> <li><p>孙组件接收</p> <div class="language- extra-class"><pre class="language-text"><code>import { inject } from &quot;vue&quot;;
setup() {
    let person = inject(&quot;user&quot;);
    return {
      person,
    };
  },
</code></pre></div></li></ul></li> <li></li></ul></li> <li><h4 id="响应式数据的判断"><a href="#响应式数据的判断" class="header-anchor">#</a> 响应式数据的判断</h4> <ul><li><strong>isRef</strong>:检查一个值是否是<strong>ref</strong>对象</li> <li><strong>isReactive</strong>:检查一个对象是否是由<strong>reactive</strong>创建的响应式对象</li> <li><strong>isReadonly</strong>:检查一个对象是否是由<strong>readonly</strong>创建的只读代理</li> <li><strong>isProxy</strong>:检查一个对象是否是由<strong>reactive</strong>或者<strong>readonly</strong>方法创建的代理对象</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn/toref.html" class="prev">
        toref的使用
      </a></span> <span class="next"><a href="/learn/flag.html">
        与vue2对比
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.175be109.js" defer></script><script src="/assets/js/2.3e96f17d.js" defer></script><script src="/assets/js/13.aee09df5.js" defer></script>
  </body>
</html>
